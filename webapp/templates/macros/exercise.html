{% macro render_feedback(unit, exercise, is_feedback_box, result, feedback_message, your_answer, user_answer, incorrect_question) %}

    {% if is_feedback_box and result %}
        {% if result == 'correct' %}
            <div class='feedback-correct-container'>
                <p class="correct">Correct</p>
                {% if feedback_message %}
                    <p class="feedback-message">{{ feedback_message | safe }}</p>
                {% endif %}

                <div class="flag-form-container">
                    <button type="button"
                            class="flag-button"
                            title="Flag this answer as having an error"
                            onclick="toggleFlagForm(this)">
                        &#127987;
                    </button>

                    <form action="{{ url_for('routes.flag_question', unit=unit, exercise=exercise) }}"
                          method="post"
                          class="flag-form hidden">

                        <input type="hidden" name="feedback_message" value="{{ feedback_message }}">
                        <input type="hidden" name="user_answer" value="{{ user_answer }}">
                        <input type="hidden" name="result" value="{{ 'Correct' if result == 'correct' else 'Incorrect' }}">

                        <textarea name="reason"
                                  rows="3"
                                  placeholder="Reason for flagging"
                                  required></textarea>

                        <button type="submit">Enter</button>
                    </form>
                </div>
            </div>
        {% else %}
            <div class='feedback-incorrect-container'>
                <p class="incorrect">Incorrect</p>
                {% if feedback_message %}
                    <p class="feedback-message">{{ feedback_message | safe }}</p>
                {% endif %}
                <p class="feedback-message">{{ your_answer | safe }} {{ user_answer }} {{ incorrect_question | safe }}</p>

                <div class="flag-form-container">
                    <button type="button"
                            class="flag-button"
                            title="Flag this answer as having an error"
                            onclick="toggleFlagForm(this)">
                        &#127987;
                    </button>

                    <form action="{{ url_for('routes.flag_question', unit=unit, exercise=exercise) }}"
                          method="post"
                          class="flag-form hidden">

                        <input type="hidden" name="feedback_message" value="{{ feedback_message }}">
                        <input type="hidden" name="user_answer" value="{{ user_answer }}">
                        <input type="hidden" name="result" value="{{ 'Correct' if result == 'correct' else 'Incorrect' }}">

                        <textarea name="reason"
                                  rows="3"
                                  placeholder="Reason for flagging"
                                  required></textarea>

                        <button type="submit">Enter</button>
                    </form>
                </div>
            </div>
        {% endif %}
    {% endif %}

{% endmacro %}